<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<body bgcolor="#FFFFFF">


<h2>
<center>
Acquiring your data</h2></center>
</center>
This page is intended to help people who are working at the Surgical Planning
Lab(SPL)  to get their data into a safe place to begin working with the slicer.
The data may be data from the scanners at Brigham and Women's Hospital, or
data that will be imported from other sites. 
check the appropriate link below for your particular situation. 
<p>
<ul>
<LI> <A HREF="#a">Recent MR scans done at Brigham and Women's Hospital</A>
<LI> <A HREF="#b">Older MR scans done at  Brigham and Women's Hospital</A>
<LI> <A HREF="#c"> Recent(within 3 months) CT scans done at  Brigham and Women's Hospital</A>
<LI> <A HREF="#d"> Older CT scans done at  Brigham and Women's Hospital</A>
<LI> <A HREF="#e">Any MR or CT scans that you would like to acquire via FTP from a remote site</A>
<LI> <A HREF="#f">Any MR or CT scans that you have stored on a CDROM that were acquired at a remote site</A>
</ul>
<TD>
<CENTER><P><A NAME="a"><B>Recent MR scans done at Brigham and Women's Hospital</B></A></P></CENTER>
Currently there are 6 MR scanners at the hospital main campus: 
<ul> 
<li> MR1 - main clinical scanner
<li> MR2 - clinical and  research scanner
<li> MR3 - cardiac and research scanner
<li> MRT -  open magnet for surgical cases
<li> MRMAX - clinical scanner
<li> CNIMR1 - Center for Neuroimaging
</ul>
Data from  all of these scanners is directly available for the most recent cases. Data from each scanner is stored in an image database dedicated to the scanner.
The data is queued in the database and archived to tape and dequeued 
as newer cases are done.
The data persists for varying lengths of time, depending on the volume of 
scans being done on the scanners. Generally, the clinical scanners are 
busier and data is available for less time. Here are the typical days
of on-line storage for each scanner:
<ul>
<li> MR1 - (7 days)
<li> MR2 - (11 days)
<li> MR3 - (10 days)
<li> MRT - (120 days)
<li> MRMAX - NOT ARCHIVED IN SPL
<li> CNIMR1 - (30 days)
</ul>
<p>
In order to work on your data, you will need to know the 8-digit  Medical Record Number(MRN). Also, you will need to find out on which scanner your 
data was acquired, change to the appropriate directory, and make a copy of the 
data. The directories containing the data are read-only! The SPL provides 
limited short term storage in a a file system located in directory /spl/tmp
This location currently provides 100 gigabytes of storage. Data in this area
will persist for 2 weeks from the time it is last accessed.
It is recommended that this  "staging area" be used to sort out 
your data and find the relevant series of interest. 
For longer term storage ask your supervisor for some disk space. Most 
datasets are either 512x512 resolution or 256x256 resolution and from 
50 to hundreds of images, so disk space needed is substantial: from 20
to several hundred megabytes per dataset.
</p>
	For example, if your data was generated on the main clinical
scanner and the MRN is 12345678 you could use the following sequence of 
commands:
<ol>
<li>
make a working directory for yourself in the temporary storage
area: </li> <br>
mkdir /spl/tmp/your_name <br>
<li> change to the directory with the patient data - the naming schemes for 
the scanners are the same as the scanner names above so: </li> <br>
cd /d/MR1/images/idb/GINX/GENESIS/BWS/12345678 <br>
<li> cp the data to the working area: <br>
cp -r * /spl/tmp/your_name</li> <br> <br>
</ol>
Now you have a copy of your data to work with!
Please proceed to <A HREF="import.html">Understanding and Importing your data into the slicer</A>


</TD>

<CENTER><P><A NAME="b"><B>Older MR scans done at  Brigham and Women's Hospital</B>    </A></P></CENTER>
We have a long term backup of virtually all MR cases. These cases are stored on older
style exabyte tapes as unix tar files. Our current procedure is somewhat cumbersome to use.  In order to find your data you will need to know the Medical Record Number(MRN) or the patient name. Since the MRN is
unique and the patient name may be very commom, it is best to use the MRN. It is also very useful to know the date of the scan that you are interested in so that you can determine which case you want to restore if there are multiple cases for the patient from multiple cases. This is actually the rule rather than the exception. Data
archives are separated by scanner. Each scanner has it's own series of tapes
and also a command for searching the database for the data you are seeking:
<ul>
<li> MR1 - where1
<li> MR2 - where2
<li> MR3 - where3
<li> MRT - wheremrt
<li> CNIMR1 - wherecni
</ul>
To find an older MR case in the data base use the following procedure
to search thru the tape archives for your data:
<ol>
<li>
run a script to setup the above commands:
 </li> <br>
source /local/bin/setup_search
<li> search for your data in the appropriate database - in this example we
will search the MR1 database for MRN 12345678 <br>
where1 12345678</li> <br> 

this will produce entries of the following form:<br>

/d/nile/backups/MR1/95111/tar25:12345678    <br>
/d/nile/backups/MR1/96011/tar12:123456789   <br>
<br>
The key field above is the one after MR1 e.g. 96011 - this tells the date
and tar file: 96 is the year 1996 01 is month 01(january) and the last 1 is
the tape number. You can use this information to determine if you have the
correct dataset. The next step is to:<br>
<li> make sure you have disk space for the data and send the disk locatation to store the data and the text representing your dataset of interest e.g. /d/nile/backups/MR1/96011/tar12:123456789 to: 
<a href="mailto:andre@bwh.harvard.edu">Andre Robatino</a> 
He is the manager of the SPL data archive and he can restore the data for you. 
<br><br>
Now you have a copy of your data to work with!
Please proceed to <A HREF="import.html">Understanding and Importing your data into the slicer</A>
</li>
</ol>
<TD>
<CENTER><P><A NAME="c"><B>Recent(up to 3 months)  CT scans done at Brigham and Women's Hospital</B></A></P></CENTER>
Currently the SPL does not maintain archives of the CT data. In order to 
access recent CT cases, you will need to use the Partners HealthCare System 
Radiology Web Server. To do this, please follow the above steps:
<ol>
<li> get a BICS account(if you dont already have one) - you can do this through Suzanne Nagle at  x2-6723 or Cheryl Mcdonald-Spriggs  at x2-6266. After you get
your BICS account you will be able to look up information in hospital database
and view images with your browser, but in order to transfer the image to the
SPL you will need to:
<li> contact Bill Hanlon at x2-9716 or Dave Gigas at x2-6512  and ask to have your
BICS account modified to include transfer privileges Also, make sure that your browser
accepts cookies, or you will not be able to use your BICS account!
<li> point your browser at <a href="https://radweb.partners.org/">RadReport</a>
<li> click on RadReport and enter your BICS access key that you received From
Suzanne or Cheryl and enter Submit

<li> Enter the Medical Record Number(MRN) of the patient or do a BWH search to 
find the information for recent cases. Most of this page is self-explanatory.  	
The one important field that is not obvious is the one labelled Stat and it is
important to know what the letters stand for:  S -> scheduled,  I ->In progress, C -> Completed, D -> Dictated, P -> Preliminary Report available, F -> Finalized Report, A -> Report Addendum, X -> Cancelled exam. Reports that are not in 
F -> Finalized are not likely to be available.

<li> once you have located the dataset of interest, you can view any or all of the images in the series to determine if this is the data that you want. Select
images and hit the View Image(s) button.
<li> next go back a page to transfer the images - hit the Transfer button. Again, you can select any or all images to transfer and hit the transfer button that
is on this page. 
<li> "Select Transfer compressed .gz" and hit "Do it!" this will build a 
compressed tar file of your images and it may take quite a while to complete
if you are getting a lot of images. 
<li> when it is done, hit the "Click to download study" button. By default, 
the data will go to your home directory, so make sure to change this to 
another location.  
<li> change (use the cd command) to go to the directory where your data 
has been transferred to. There will be a file there called images.tar
which will be a compressed tar file
<li> extract the tar file with the unix command <br>
tar xvf images.tar
<li> uncompress the tar file with the command <br>
gunzip -r images 
<li>
remove the tar file with:<br>
rm images.tar
</ol>

<br>
Now you have a copy of your data to work with!
Please proceed to <A HREF="import.html">Understanding and Importing your data into the slicer</A>
<CENTER><P><A NAME="d"><B>Older CT scans done at  Brigham and Women's Hospital</B></A></P></CENTER>
The PACS system only keeps data online for 1 to 3 months based on the volume of
cases. The data is then archived to Optical Disk which is not accessible
directly via the Radweb interface. To get these older cases you will need to
use one of the following  procedures. The first method is preferred.
<ol>
<li> get a BICS account(if you dont already have one) - you can do this through Suzanne Nagle at  x2-6723 or Cheryl Mcdonald-Spriggs  at x2-6266. After you get
your BICS account you will be able to look up information in hospital database
and view images with your browser, but in order to transfer the image to the
SPL you will need to:
<li> contact Bill Hanlon at x2-5938 or Dave Gigas at x2-6512  and ask to have your
BICS account modified to include transfer privileges. Also, make sure that your browser 
accepts cookies, or you will not be able to use your BICS account!
<li> point your browser at <a href="https://radweb.partners.org/">RadReport</a>
<li> click on RadReport and enter your BICS access key that you received From
Suzanne or Cheryl and enter Submit
<li>Hit the Search PACS button
<li> Enter the MRN and as much information that you know about the study that you
want to restore in the white box and hit the Submit Query button
<li> A list of cases matching your search criteria will be displayed as hypertext links.
To put your case in the retrieval queue just click on the link. The case should be
restored within 1 hour and will persist in the Radweb database for 30 days. 
<li> After waiting an hour for the case to be restored, follow steps 6-13 above to 
finish restoring the data. Note that this method will only work for cases
scanned after September 1998.
</ol>
<nl> 
<nl> 
Alternate (less preferred procedure below)
<nl>


<ol>
<li> go to the CT reading area and ask for the chief tech or someone who can
help to restore a case to the PACS from the optical disk. It will be necessary to know the patient name, MRN, and the date of the exam. Unfortunately, we
do not have an established person to handle this procedure. It is sometimes
difficult to find a person who is capable of assisting in this regard.
The data is automatically restored so that it is visible from the CT consoles.

<li> When the case is restored to the PACS, it will show up in a list of 
patients available for display at the CT reading stations. From the console,
(preferably have one of the techs) choose to send the data to remote
destination SPL - this will send the data to the SPL.
<li> Once the data is sent back to the SPL, it will be available in 
directory /spl/tmp/incoming.
</ol>
</li>
<br>
This data will be in DICOM format so you can proceed to either:
<A HREF="slicer_dicom.html">Reading DICOM data into 3D Slicer</A>
or <br>
<A HREF="import.html">Understanding and Importing your data into the slicer</A>
<CENTER><P><A NAME="e"><B>Any MR or CT scans that you would like to acquire via FTP from a remote site</B></A></P></CENTER>
The SPL provides an anonymous ftp server. In order to get data to SPL via ftp
use the following commands:
<ol>
<li> ftp -i to duke.bwh.harvard.edu (dukes ip address is 134.174.9.66)
<li> login as anonymous, give your email address as password
<li> cd pub/incoming
<li> binary (puts you in binary file mode)
<li> mput * (this assumes that you are in the directory where the remote images
exist)
<li> locally in the SPL, cd /d/ftp/pub/incoming
<li> cp your files to a place to work on them i.e. <br>
cp your_images /spl/tmp/your_name
<li> after you have made a copy of your data, make sure to remove your 
files from the ftp directory.
</ol>
Now you have a copy of your data to work with!
Please proceed to <A HREF="import.html">Understanding and Importing your data into the slicer</A>
<CENTER><P><A NAME="f"><B>Any MR or CT scans that you have stored on a CDROM that were acquired at a remote site</B></A></P></CENTER>
Most of the workstations in the SPL are equipped with CDROM readers. To get 
your data from CDROM to the SPL you will need to use the following procedure.
<ol>
<li> insert your CD into the CD reader. 
<li> on the same workstation, change to the directory where the CDROM is  
mounted. The mount point is /cdrom so the command is:<br>
cd /cdrom
<li> look in this directory for your data - it may take a few minutes to 
mount the drive so be patient
<li> when your data shows up, copy it to a "staging area" so that you can 
sort through it i.e.:<br>
<li> cp -r * /spl/tmp/yourname
<li> eject the CD with the command <br>
eject
<li> dont forget to remove your CD!
</ol>
Now you have a copy of your data to work with!
</body>
</html>
