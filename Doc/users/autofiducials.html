<head>
</head>
<title>Fiducials</title>
<body bgcolor="white">
<p>
<h1>Fiducials</h1>

If you have any questions/suggestions about this module, please email the  <a href=slicer-developpers@bwh.harvard.edu> slicer-developper list </a>
<p>

Fiducial points are little diagonal glyphs that can be added on any volume in the 2D slice windows or any models in the 3D windows. Fiducial points can be used for measuring distances, angles or for reformatting or registration.
<p>
<b> Here are basics about Fiducials for Users</b>:
<p>
<ul>
<li>Fiducial points are grouped in lists. Each Fiducial list has a name. 
You have to select a list before creating a Fiducial point. 
If you want to create a new list, go to the Fiducials module and enter a new 
list name. 

<li> Here are commands to create/select/delete Fiducial points:
<ul>
<li>To create a Fiducial point: point to the location with the mouse and press 'p' on the keyboard.</li>
<li>To select/unselect a Fiducial point: point to the Fiducial that you want to select/unselect with the mouse and press 'q' on the keyboard.</li>
<li>To delete a Fiducial: point to the Fiducial that you want to delete with the mouse and press 'd' on the keyboard. </li> 
</ul>
<p>
NOTE: it is important to press 'p' and not 'P', 'd' and not 'D' and 'q' and not 'Q'. "
<p>
<li> As soon as a Fiducial list contains a point in it, the Mrml tree is updated. This means that all non-empty Fiducial lists will be saved in the Mrml file if you save the current scene with the Menu->"Save Scene As" option.
Similarly, if you load a Mrml file with Fiducial lists, the Fiducial points will be created automatically.
<li> Here is what a Fiducial list looks like in Mrml:
<br>
MRML
<br>
Fiducials
<br>&nbsp&nbsp&nbsp  Point name='PNT0' xyz='-1.01939e-06 57.2394 -43.4416' /Point
<br>&nbsp&nbsp&nbsp  Point name='PNT1' xyz='15 52.4472 33.4648' /Point
<br>&nbsp&nbsp&nbsp  Point name='PNT2' xyz='40 96.2722 -33.4119' /Point
<br>/Fiducials
<br>/MRML

</ul>

<p>

<b>Here are basics about Fiducials for Developpers</b>:

<ul> It is very straightforward to use Fiducials inside your own module. It takes one line to add a Fiducials display (menu to select a list + scrollList that shows all the points for the selected list) and one line to query the xyz world coordinates of the points for any particular list. Here is a step by step description of what you should do to use Fiducials:
<p>
<li> First, you need to tell slicer that your module depends on the Fiducials module, so add this line to your <code><b>Init</b></code> procedure if it is not already there:

<p><code> # Define Dependencies
<br> set Module($m,depend) Fiducials
</code>
<p></li>
<li> Many modules in Slicer might use Fiducials. You might want a Fiducials list with a particular name to be created especially for your module and activated when the user enters your module. That way, when the user creates Fiducials while using your module, all the Fiducials points will belong to one list. This makes it easy to query only the position of those points by using the list name (see below). Here is how to create and active a Fiducials list call "MyCoolList" when the user enters the Tab for the module "MyCoolProgram": <p>
<ul> 
<li>Go inside your "Init" procedure. Add: <p>
<code> set MyCoolProgram(fiducialsListCreated) 0 </code></li>
<p><li>Go inside your "Enter" procedure. <br> (<i> note:  The Enter procedure is defined as follows for every module: </i><br>
<code> set m MyCoolProgram <br>
set Module($m,procEnter) MyCoolProgramEnter </code>, 
<i><br> so here </i><code>MyCoolProgramEnter</code> <i>is the procEnter procedure for the "MyCoolProgram" module). </i>).</li>
<p><li> Add: <p>
<code>
if {$MyCoolProgram(fiducialsListCreated) == 0} { <br>
	set MyCoolProgram(fiducialsListCreated) 1 <br>
	FiducialsCreateFiducialsList "default" "MyCoolList" <br>  
    }  <br>
    FiducialsSetActiveList "MyCoolList" <br>
</code><p>
You should always use the "default" type of Fiducials unless you want to define your own type of Fiducials inside the MRML Fiducials File (if you want them to have a different look for example, see the "endoscopic" type for example).
</li>
</ul>

</li></ul>
<table>
<tr>

<td align="left">
<ul>
<li> You might also want to add the Fiducials gui (shown on the right) to the panel of your Module. so the user can have directly access to the list of points without having to go to the Fiducials Tab. <br> Add this line in your <code><b>BuildGUI</b></code> procedure:

<ul>
<p><code> FiducialsAddActiveListFrame $frame 7 25 "reformat"</code><p>
<li> <code>$frame</code> is whatever frame you want to pack the panel into
<li> The next 2 arguments are the height and width of the scroll list
<li> The last argument is a list of Fiducial list names that you would like to use for your module (those names will appear on the menu).
</ul>

</td>
<td align="right">
Here is the Fiducial panel <img src='fiducials.jpg'></img> 
</td></tr> </table>

</table>
<li> Now when the user enters your module, your list is activated and the user is able to create/select/delete Fiducials by using the usual Fiducials user interface (key presses). If you want to access information about Fiducials, here are <b>useful procedures</b>:

<ul>
<p>
<li> 
<p>
<code> FiducialsGetPointIdListFromName $list </code>
<p>
<br> This returns a list of <b>point ids</b> that belong to the Fiducial list with the name <code>$list</code>. 
<p>
<li> Once you have the point Ids, you can find out their <b>coordinates</b> by calling:
<p> 
<code> FiducialsGetPointCoordinates $pid </code>
<p>
<br> This returns a list of 3 coordinates (x,y,z)
<p>
<li> In case you only care about the <b>selected</b> points for a particular list, you can call:
<p>
<code> FiducialsGetSelectedPointIdListFromName $list </code>
<p>
<br> This returns a list of only the selected point Ids for the list with the name $name.
<p>
<li> In case you want <b>all</b> the selected point Ids, <b>regardless of which list</b> they belong to, you can call:
<p>
<code> FiducialGetAllSelectedPointIds </code>
<p>
<br> This returns a list of all selected point Ids.
</ul>
<p>
<li> Here is a list of other possible features for Fiducials that would be good if anybody wants to contribute to the Fiducials module:
<ul>
<li> ability to right click on the Fiducial point inside the scroll list and change the name and the color of the point
<li> ability to measure a distance between 2 selected fiducials
<li> ability to measure an angle between 3 selected fiducials
</body>


