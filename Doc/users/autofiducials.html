<head>
<title>Fiducials</title>
</head>
<body bgcolor="white">



Fiducial points are little diagonal glyphs that can be added on any volume in the 2D slice windows or any models in the 3D windows. Fiducial points can be used for measuring distances or angles, or for reformatting or registration.
<p>
<b>About Fiducial points</b>:</p>
<ul>
<li>Fiducial points are grouped in lists. Each Fiducial list has a name.
You have to select a list before creating a Fiducial point.
To create a new list, use the <b>Fiducials</b> module and enter a new
list name.</li>

<li>Commands to create, select, and delete Fiducial points:
    <ul>
    <li>To create a Fiducial point: point to the location with the mouse and press 'p' on the keyboard.</li>
    <li>To select/unselect a Fiducial point: point to the Fiducial that you want to select/unselect with the mouse and press 'q' on the keyboard.</li>
    <li>To delete a Fiducial: point to the Fiducial that you want to delete with the mouse and press 'd' on the keyboard. </li>
    </ul>
<p>
NOTE: it is important to press 'p' and not 'P', 'd' and not 'D', and 'q' and not 'Q'. </p>
</li>
<li>As soon as a Fiducial list contains one point, the MRML (Medical Reality Modeling Language) tree is updated. This means that all non-empty Fiducial lists will be saved in the MRML file, if you save the current scene with <b>Save Scene As</b>.
Similarly, if you load a MRML file with Fiducial lists, the Fiducial points will be created automatically.</li>
<li> In MRML, a Fiducial list looks like this:
<code>    <br>
    &lt;MRML&gt;
    <br>
    &lt;Fiducials&gt;
    <br>&nbsp;&nbsp;&nbsp;&lt;Point&gt; name='PNT0' xyz='-1.01939e-06 57.2394 -43.4416' &lt;/Point&gt;
    <br>&nbsp;&nbsp;&nbsp;&lt;Point&gt; name='PNT1' xyz='15 52.4472 33.4648' &lt;/Point&gt;
    <br>&nbsp;&nbsp;&nbsp;&lt;Point&gt; name='PNT2' xyz='40 96.2722 -33.4119' &lt;/Point&gt;
    <br>&lt;/Fiducials&gt;
    <br>&lt;/MRML&gt;
</code>
</li>
</ul>

<p>
Here is a list of new features for Fiducials that will appear soon:</p>
<ul>
<li> ability to right-click a Fiducial point inside the scroll list and change the name and the color of the point.</li>
<li> ability to measure a distance between 2 selected fiducials.</li>
<li> ability to measure an angle between 3 selected fiducials.</li>
</ul>

<p>

<b>Details about Fiducials for Developers</b>:</p>

<ul>Using Fiducials inside your own module is straightforward.
It takes one line of code to add a Fiducials display
(a menu to select a list and a scrollList that shows all the points for the selected list)
and one line to query the xyz-world coordinates of the points for any particular list. <br>
Here is a step-by-step description of how to use Fiducials:
<li> First, you need to tell Slicer that your module depends on the <b>Fiducials</b> module, so add this line to your <code><b>Init</b></code> procedure, if it is not already there:

<br><code> # Define Dependencies
<br> set Module($m,depend) Fiducials
</code>
</li>
<br><br>
<li> Next, you need to use the <code>Fiducials(eventManager)</code> to recognize the 'p', 'q', and 'd' keys. To do that, add this line to the <code><b> Enter </b></code> procedure in your module:

<br><code> global Fiducials
<br> pushEventManager $Fiducials(eventManager)
</code>
</li>

<br><br>
<li> Now, you should add the Fiducials GUI (below) to the panel of your module.
Add this line in your <code><b>BuildGUI</b></code> procedure:

<ul><code> FiducialsAddActiveListFrame $frame 7 25 "reformat"</code>
<li> <code>$frame</code> is whatever frame you want to pack the panel into.</li>
<li> The next 2 arguments are the height and width of the scroll list.</li>
<li> The last argument is a list of Fiducial list names that you would like to use for your module (those names will appear on the menu).</li>
</ul>
</li>
</ul>
Now when the user enters your module, the user is able to create, select, and delete Fiducials by using the usual Fiducials user interface (key presses). <br>
<br>

To access information about Fiducials, here are useful procedures:
<ul>
<li>
<code> FiducialsGetPointIdListFromName $name </code>
<br> This returns a list of point Ids that belong to the Fiducial list with the name <code>$name</code>.
</li>
<br><br>
<li> Once you have the point Ids, you can find out their coordinates by calling:
<br><code> FiducialsGetPointCoordinates $pid </code>
<br> This returns a list of 3 coordinates (x,y,z).
</li>
<br><br>
<li> In case you only care about the selected points for a particular list, you can call:

<code> FiducialsGetSelectedPointIdListFromName $name </code>
<br> This returns a list of only the selected point Ids for the list with the name <code>$name</code>.
</li>
<br><br>
<li> In case you want all the selected point Ids, regardless of which list they belong to, you can call:
<code> FiducialGetAllSelectedPointIds </code>
<br> This returns a list of all selected point Ids.</li>
</ul>


</body>


