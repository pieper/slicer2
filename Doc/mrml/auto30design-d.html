<title>Proposed Details</title>

<ul>
<li><a href='http://splweb.bwh.harvard.edu:8000/cgi-bin/develop/viewcvs.cgi/slicer/dtd/mrml26.dtd'>Proposed DTD</a>
</ul>

The proposed MRML specification differs from the current by the addition
of support for volume rendering and hierarchical models.
<p>
Handling volume rendering involves transfer functions for each color
componend (R,G,B) and opacity.  The window/level/threshold attributes of
current Volume nodes will be removed and replaced with Transfer Function nodes.
This architecture more closely resembles the model of a <i>normalized database</i>.
There will be standard Window/Level nodes for viewing CT data of various
anatomy such as brain, abdomen, etc.

<!-- ------------------------------------------ !-->

<h3>Volume Node</h3>
A proposed addition to the volume node is as follows:
<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>id</td>
<td class=box0>Required, a unique id for this volume, defaults to ID</td>
</tr>
<tr>
<td class=box1>transferFunction</td>
<td class=box1>An implied attribute</td>
</tr>
</table>

<!-- ------------------------------------------ !-->

<h3>Model Node</h3>
A proposed addition to the model node is as follows:
<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>id</td>
<td class=box0>Required, a unique id for this model</td>
</tr>
<tr>
<td class=box1>displayProperties</td>
<td class=box1>Moved the display properties from this node into a new DisplayProperties node</td?
</tr>
</table>


<!-- ------------------------------------------ !-->

<h3>DisplayProperties Node</h3>
This node encapsulates information about how to display a model or a model group.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>id</td>
<td class=box0>Unique identifier of the display properties node, required</td>
</tr>
<tr>
<td class=box1>name</td>
<td class=box1>Name displayed on the user interface, defaults to ""</td>
</tr>
<tr>
<td class=box1>colorName</td>
<td class=box1>Name of the model's color, which is defined by a Color node in a MRML file. Defaults to ""</td>
</tr>
<tr>
<td class=box0>opacity</td>
<td class=box0>Opacity of the surface expressed as a number from 0 to 1, default 1.0</td>
</tr>
<tr>
<td class=box1>visibility</td>
<td class=box1>Indicates if the surface is visible. Can be true or false, defaults to true</td>
</tr>
<tr>
<td class=box0>clipping</td>
<td class=box0>Is clipping active? Default = false</td>
</tr>
<tr>
<td class=box1>backfaceCulling</td>
<td class=box1>Is backface culling active? Default = true</td>
</tr>
<tr>
<td class=box0>scalarVisibility</td>
<td class=box0>Defaults to false</td>
</tr>
<tr>
<td class=box0>scalarRange</td>
<td class=box0>Defaults to "0 100"</td>
</tr>
</table>
<!-- ------------------------------------------ !-->

<h3>Transform Node</h3>

A Transform node can contain zero or more Matrix nodes, as well as zero or more of Transform or Volume or Model or ModelGroup nodes. 
This is a grouping node, and will be expanded to include other types of coordinate transformations than just Matrix.

<!-- ------------------------------------------ !-->

<!-- removed from 2.4 to 2.5
<h3>Fiducials Node</h3>
!-->

<!-- ------------------------------------------ !-->

<h3>ColorLUT Node</h3>

Information about color look up table.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>name</td>
<td class=box0>A required attribute</td>
</tr>
<tr>
<td class=box1>numberOfColors</td>
<td class=box1>Defaults to 256</td>
</tr>
<tr>
<td class=box0>fileName</td>
<td class=box0>Defaults to ""</td>
</tr>
<tr>
<td class=box1>hueRange</td>
<td class=box1>A pair of numbers giving the hue range. Defaults to "0 0.8"</td>
</tr>
<tr>
<td class=box0>saturationRange</td>
<td class=box0>A pair of numbers givin the saturation range. Defaults to "0 0"</td>
</tr>
<tr>
<td class=box1>valueRange</td>
<td class=box1>Defaults to "0 1"</td>
</tr>
<tr>
<td class=box0>annoColor</td>
<td class=box0>Defaults to "1 0 0"</td>
</tr>
</table>

<!-- ------------------------------------------ !-->

<h3>TransferFunction Node</h3>

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>name</td>
<td class=box0>A required attribute</td>
</tr>
</table>

<!-- ------------------------------------------ !-->

<h3>Hierarchy Node</h3>

An hierarchy node can hold zero or more of a model group, or a model ref node.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>id</td>
<td class=box0>If you have more than one hierarchy in the file, use this to differentiate them. Required, but programatically defaults to "H1"</td>
</tr>
<tr>
<td class=box1>type</td>
<td class=box1>The type of the hierarchy. Can be MEDICAL or LANGUAGE, defaults to MEDICAL</td>
</tr>
</table>

<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>ModelGroup Node</h4>

A node of the hierarchical tree, not connected to a model. 

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>id</td>
<td class=box0>Unique identifier of the model group, required</td>
</tr>
<tr>
<td class=box1>name</td>
<td class=box1>Name displayed on the user interface, defaults to ""</td>
</tr>
<tr>
<td class=box0>description</td>
<td class=box0>Optional text description of the data, defaults to ""</td>
</tr>
<tr>
<td class=box1>displayProperties</td>
<td class=box1>Moved the display properties from this node into a new DisplayProperties node</td?
</tr>
<tr>
<td class=box0>overRideChildProperties</td>
<td class=box0>Do the display properties of the group override the display properties of any child models? Defaults to true</td>
</tr>
</table>


<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>ModelRef Node</h4>

A reference to a model.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>modelRefId</td>
<td class=box0>Required, ID of the referenced model.</td>
</tr>
</table>

<!-- ------------------------------------------ !-->

<h3>Scene Node</h3>

A scene node can hold a matrix, a volume state, a model state, scene options, options, a cross section, a locator.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>lang</td>
<td class=box0>Language, not used, default ""</td>
</tr>
<tr>
<td class=box1>name</td>
<td class=box1>Name of the scene, default ""</td>
</tr>
<tr>
<td class=box0>description</td>
<td class=box0>A short description of the scene, default ""
</td>
</tr>
</table>

<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>Matrix Node</h4>
<a href="index.html#3c">As previously defined</a>

<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>VolumeState Node</h4>

State of a volume data set as visible in one scene.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>volumeRefId</td>
<td class=box0>ID of the referenced volume. A required attribute</td>
</tr>
<tr>
<td class=box1>colorLUT </td>
<td class=box1>Color look up table, default 0</td>
</tr>
<tr>
<td class=box0>foreground</td>
<td class=box0>Is the volume showing in the foreground? A fading option, default false</td>
</tr>
<tr>
<td class=box1>background</td>
<td class=box1>Is the volume shown in the background? A fading option, default false</td>
</tr>
<tr>
<td class=box0>fade</td>
<td class=box0>Is the volume faded? A fading option, default false</td>
</tr>
<tr>
<td class=box1>opacity</td>
<td class=box1>Opacity of the volume. A fading option, default 1.0</td>
</tr>
</table>


<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>ModelState Node</h4>

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>modelRefID</td>
<td class=box0>ID of the referenced model. A required attribute</td>
</tr>
<tr>
<td class=box1>visible</td>
<td class=box1>Visibility, an attribute of the model, default true</td>
</tr>
<tr>
<td class=box0>opacity</td>
<td class=box0>Opacity, an attribute of the model, default 1.0</td>
</tr>
<tr>
<td class=box1>sliderVisible</td>
<td class=box1>Visibility of the opacity slider. Used in SPLVis, not Slicer. Defaults to true</td>
</tr>
<tr>
<td class=box0>childrenVisible</td>
<td class=box0>Are the children of this node visible? Only used for model groups. Default = true</td>
</tr>
<tr>
<td class=box1>clipping</td>
<td class=box1>Is clipping active? Default = false</td>
</tr>
<tr>
<td class=box0>backfaceCulling</td>
<td class=box0>Is backface culling active? Default = true</td>
</tr>
</table>


<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>SceneOptions Node</h4>


<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>showAxes</td>
<td class=box0>Show the 3D axes? An annotation option, can be true or false, default false</td>
</tr>
<tr>
<td class=box1>showBox</td>
<td class=box1>Show 3D cube? An annotation option, can be true or false, default true</td>
</tr>
<tr>
<td class=box0>showAnnotations</td>
<td class=box0>Show slice window text? An annotation option, can be true or false, default false</td>
</tr>
<tr>
<td class=box1>showSliceBounds</td>
<td class=box1>Show 3D outline around slices? An annotation option, can be true or false, default false</td>
</tr>
<tr>
<td class=box0>showLetters</td>
<td class=box0>Show 3D Letters? Defaults to true.</td>
</tr>
<tr>
<td class=box1>showCross</td>
<td class=box1>Show the crosshair? Defaults to true.</td>
</tr>
<tr>
<td class=box0>showHashes</td>
<td class=box0>Show hash marks? Defaults to true.</td>
</tr>
<tr>
<td class=box1>showMouse</td>
<td class=box1>Not used in Slicer, only for SPLViz compatibility. Show the mouse pointer? Defaults to true.</td>
</tr>
<tr>
<td class=box0>viewUp</td>
<td class=box0>View up direction for the camera, VTK camera option, default "0 1 0"</td>
</tr>
<tr>
<td class=box1>position</td>
<td class=box1>The position of the camera in world coordinates, VTK camera option, default "0 0 1"</td>
</tr>
<tr>
<td class=box0>clippingRange</td>
<td class=box0>3D view, the near and far clipping planes, VTK camera option, default "0.1 1000"</td>
</tr>
<tr>
<td class=box1>focalPoint</td>
<td class=box1>VTK camera option, the focal point of the camera in world coordiantes, default "0.0 0.0 0.0"</td>
</tr>
<tr>
<td class=box0>viewAngle</td>
<td class=box0>VTK camera option, angular height of the camera view, in degrees, default "30"</td>
</tr>
<tr>
<td class=box1>viewMode</td>
<td class=box1>The current slicer viewing mode (3D, 4x512, 4x256...)default ""</td>
</tr>
<tr>
<td class=box0>viewBgColor</td>
<td class=box0>Background color of the 3D view: blue, black, or midnight, defaults to ""</td>
</tr>
</table>


<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>Options Node</h4>
<a href="index.html#3c">As previously defined</a>

<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>CrossSection Node</h4>

This node holds information about the state of the saved volume. It gives camera positioning information that allows the view to be reproduced the next time the volume is loaded. <br>To be finished.

<table cellpadding=3 cellspacing=3 border=0>
<tr>

<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>position</td>
<td class=box0>Which cross section is referenced. A required attribute, can be 0, 1, or 2, defaults programatically to 0</td>
</tr>
<tr>
<td class=box1>direction</td>
<td class=box1>Can be axial, coronal, sagittal, or none. Defaults to none</td>
</tr>
<tr>
<td class=box0>sliceSlider</td>
<td class=box0>Position of the slider, showing which slice is currently displayed, default is 0</td>
</tr>
<tr>
<td class=box1>rotatorX</td>
<td class=box1>Rotation X. Not used in Slicer, only in SPLVis, default 0</td>
</tr>
<tr>
<td class=box0>rotatorY</td>
<td class=box0>Rotation Y. Not used in Slicer, only in SPLVis, default 0</td>
</tr>
<tr>
<td class=box1>inModel</td>
<td class=box1>Visibility in 3D view. The slice is shown in the 3D view. Can be true or false, defaults to false</td>
</tr>
<tr>
<td class=box0>zoom</td>
<td class=box0>Zoom. Default 1.0</td>
</tr>
<tr>
<td class=box1>clipState</td>
<td class=box1>Clipping state. Can be true or false, defaults to true </td>
</tr>
<tr>
<td class=box0>backVolRefId</td>
<td class=box0>ID of background volume</td>
</tr>
<tr>
<td class=box1>foreVolRefId</td>
<td class=box1>ID of foreground volume</td>
</tr>
<tr>
<td class=box0>labelVolRefID</td>
<td class=box0>ID of label volume</td>
</tr>
</table>


<!-- ---   ---   ---   ---   ---   ---   ---   ---  !-->

<h4>Locator Node</h4>

Holds the options for the locator.

<table cellpadding=3 cellspacing=3 border=0>
<tr>
<th class=box>Key</th>
<th class=box>Value</th>
</tr>
<tr>
<td class=box0>driver</td>
<td class=box0>Who or what is driving the locator? default ""</td>
</tr>
<tr>
<td class=box1>diffuseColor</td>
<td class=box1>Locator color, default ""</td>
</tr>
<tr>
<td class=box0>visibility</td>
<td class=box0>Is the locator visible? Can be true or false, defaults to false </td>
</tr>
<tr>
<td class=box1>transverseVisibility</td>
<td class=box1>Is the transverse of the locator visible? Can be true or false, defaults to true </td>
</tr>
<tr>
<td class=box0>normalLen</td>
<td class=box0>Length of the normal of the locator, default 100 </td>
</tr>
<tr>
<td class=box1>transverseLen</td>
<td class=box1>Length of the transverse of the locator, default 25 </td>
</tr>
<tr>
<td class=box0>radius</td>
<td class=box0>Radius of the locator, default 3.0</td>
</tr>
</table>

